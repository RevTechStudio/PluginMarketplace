---
name: implementation
description: タスク計画書に基づいてコードを実装するスキル。開発規約に準拠したコード実装、テストコード作成、品質チェック、ドキュメント更新を段階的に実施し、実装フェーズを完遂する。実装、コーディング、開発、プログラミング、テスト作成について言及している場合に使用してください。
---

# Implementation

## 目的

タスク計画書に基づいて、開発チームが実装を完遂できるレベルの実装コードとテストコードに落とし込む。

## 責任範囲

- タスク計画書に従ってコンポーネント/モジュールを実装する
  - coding-conventionsに従い、保守性の高いコードを作成する
- テストコードを作成する
  - 品質を保証し、リグレッションを防ぐ
- 品質チェックを実施する
  - linter、formatter等で規約遵守を確認する
- 実装に伴うドキュメントを更新する
  - document-conventionsに従い、コードとドキュメントの一貫性を保つ
- Git運用（ブランチ、コミット）を規約に従って実施する
  - branch-commit-conventionsに準拠し、履歴を明確にする
- 実装レポートを作成する
  - 実装内容、テスト結果、品質チェック結果を記録する

**責任範囲外:**

- タスク計画の作成
  - task-planningスキルで行う内容である
- 実装順序や優先順位の決定
  - task-planningスキルで行う内容である
- 要件の変更や追加
  - requirements-definitionフェーズに戻る必要がある
- 詳細設計の変更
  - detailed-designフェーズに戻る必要がある
- インフラ構築やデプロイ設定の詳細
  - インフラ構築フェーズで行う内容である
- 本番環境へのデプロイ
  - リリースフェーズで行う内容である
- パフォーマンスチューニングの詳細
  - 実装後のパフォーマンス測定に基づいて別途行う

## 参照規約

このスキルは以下の規約を参照して実装を行う：

- **coding-conventions** - C#コーディング規約とベストプラクティス
- **branch-commit-conventions** - ブランチ、コミット、PRの命名規則
- **document-conventions** - ドキュメント作成基準

## ワークフロー

### 1. タスク計画書の確認

タスク計画書を読み込み、実装すべきタスクを把握する。
- タスクの優先順位、依存関係、見積もりを理解し、効率的に実装を進める

**読み込みの手順:**

1. 入力ファイルパスが指定されている場合は、そのファイルを読み込む
2. 入力ファイルパスが指定されていない場合は、ユーザーに確認する

**確認する項目:**

- 実装フェーズと目標
- タスク一覧（ID、タスク名、説明、成果物、見積もり、依存関係）
- 依存関係図
- スケジュールとマイルストーン
- リスクと対策

**現在のタスクの特定:**

- どのタスクから実装を開始するか確認する
- 前提タスクが完了しているか確認する
- 次に実装すべきタスクを特定する

**質問フォーマットに従い、ユーザーに確認する:**

```markdown
タスク計画書を確認しました。以下のタスクから実装を開始してよろしいでしょうか？

**次に実装するタスク:**
- [T001: タスク名] - 見積もり: [X時間]

**前提タスク:** [なし / 完了済み]

他のタスクから開始する場合は教えてください。
```

**注意:** ユーザーの承認を待ってから次のステップへ進む。

### 2. コンポーネントの実装

設計に基づきコードを実装する。
- coding-conventionsに準拠した保守性の高いコードを作成する

**実装の原則:**

- **coding-conventionsを遵守する**
  - 命名規則、コーディングスタイル、ベストプラクティスに従う
- **単一責任の原則を適用する**
  - 各クラス・メソッドは1つの責務のみを持つ
- **依存性注入を使用する**
  - テスタビリティと保守性を向上させる
- **エラーハンドリングを適切に実装する**
  - 例外処理を明確にし、エラーメッセージを適切に設定する
- **コメントを適切に記述する**
  - 複雑なロジックには説明を追加する

**実装の手順:**

1. **インターフェース/抽象クラスを定義する**
   - 依存関係を明確にし、テスタビリティを向上させる
2. **データモデル/エンティティを実装する**
   - データ構造を定義し、バリデーションを追加する
3. **データアクセス層を実装する**
   - リポジトリパターンを適用し、データ操作を抽象化する
4. **ビジネスロジック層を実装する**
   - サービスクラスでビジネスルールを実装する
5. **プレゼンテーション層を実装する**
   - コントローラー/UIでユーザーインターフェースを実装する

**各コンポーネント実装後:**

- コードレビューの自己チェックを実施する
- 次のコンポーネントに進む前にユーザーに確認する（必要に応じて）
- タスク計画書の該当タスクを完了としてマークする

### 3. テストの実装

実装したコードに対するテストを作成する。
- 品質を保証し、リグレッションを防ぐ

**テストの種類:**

#### ユニットテスト

各コンポーネントの単体テストを実装：
- **テスト対象**: 個別のクラス・メソッド
- **テスト内容**: 正常系、異常系、境界値
- **モック/スタブ**: 依存関係をモック化してテストする

#### 統合テスト

コンポーネント間の連携テストを実装（必要に応じて）：
- **テスト対象**: 複数のコンポーネントの連携
- **テスト内容**: API呼び出し、データベース操作、外部サービス連携

**テスト実装の原則:**

- **AAA（Arrange-Act-Assert）パターンを使用する**
  - テストの構造を明確にする
- **テストケース名を明確にする**
  - 何をテストしているか分かりやすい名前を付ける
- **1テスト1検証を基本とする**
  - テストの失敗原因を特定しやすくする
- **カバレッジを意識する**
  - 重要なロジックは漏れなくテストする

**テスト実装の手順:**

1. テストフレームワークを確認する
2. ユニットテストを実装する
3. テストを実行し、すべて成功することを確認する
4. 必要に応じて統合テストを実装する
5. タスク計画書の該当タスクを完了としてマークする

### 4. 品質チェックの実施

実装コードの品質を確認する。
- コーディング規約の遵守、潜在的なバグの検出を行う

**実施する項目:**

#### Linter実行

コーディングスタイルと潜在的な問題を検出：
- 未使用変数、未定義変数のチェック
- コーディング規約違反のチェック
- 複雑度の高いコードのチェック

#### Formatter実行

コードフォーマットを統一：
- インデント、改行、スペースの統一
- コードの可読性を向上させる

#### 静的解析実行（可能な場合）

静的解析ツールで潜在的なバグを検出：
- Null参照の可能性
- 型の不整合
- セキュリティ上の問題

#### テスト実行

すべてのテストが成功することを確認：
- ユニットテスト
- 統合テスト

**品質チェックの手順:**

1. Linterを実行し、警告・エラーを修正する
2. Formatterを実行し、コードフォーマットを統一する
3. 静的解析ツールを実行し、問題を修正する（可能な場合）
4. すべてのテストを実行し、成功を確認する
5. タスク計画書の該当タスクを完了としてマークする

**注意:** すべてのチェックが成功してから次のステップへ進む。

### 5. ドキュメントの更新

実装に伴うドキュメントを更新する。
- document-conventionsに従い、コードとドキュメントの一貫性を保つ

**更新する項目:**

#### README.md

プロジェクトの概要と使い方を更新：
- インストール手順
- 使用方法
- 設定方法
- トラブルシューティング

#### API仕様ドキュメント（ある場合）

実装したAPIの仕様を記載：
- エンドポイント
- リクエスト/レスポンス形式
- エラーコード

#### コード内コメント

複雑なロジックには説明を追加：
- クラス・メソッドのサマリーコメント
- 複雑なアルゴリズムの説明
- TODOコメント（必要に応じて）

#### CHANGELOG.md（ある場合）

実装した機能・変更内容を記録：
- 追加した機能
- 修正したバグ
- 破壊的変更

**ドキュメント更新の原則:**

- **document-conventionsを遵守する**
  - 日本語ドキュメント、Mermaid図の使用
- **具体的に記述する**
  - 曖昧な表現を避け、明確な説明を提供する
- **最新の状態を保つ**
  - コードとドキュメントの不整合を防ぐ

### 6. 実装レポートの作成

実装内容をレポートとしてドキュメント化する。
- 実装内容を記録し、レビューや後続フェーズで参照できるようにする

**レポート構成:**

1. **実装サマリー** - 実装した機能の概要
2. **実装内容** - 実装したコンポーネント、ファイル一覧
3. **テスト結果** - ユニットテスト、統合テストの結果
4. **品質チェック結果** - Linter、Formatter、静的解析の結果
5. **残課題** - 未実装の機能、既知の問題、TODO項目
6. **次のステップ** - 今後の実装予定

**レポート形式:**

- Markdown形式で作成する
- [実装レポートテンプレート](./templates/implementation-report-template.md)を使用する
- 保存先はユーザーに確認する
- タスク計画書の進捗を反映する

### 7. Git運用

実装したコードをGitで管理する。
- branch-commit-conventionsに準拠し、履歴を明確にする

**Git運用の原則:**

- **branch-commit-conventionsを遵守する**
  - ブランチ命名規則、コミットメッセージ形式に従う
- **適切な粒度でコミットする**
  - 論理的な単位でコミットを分割する
- **意味のあるコミットメッセージを記述する**
  - 何を変更したか、なぜ変更したかを明確にする

**Git運用の手順:**

1. **ブランチを作成する**（必要に応じて）
   - feature/、fix/等の接頭辞を使用する
2. **変更をステージングする**
   - 関連する変更をまとめてステージングする
3. **コミットする**
   - Conventional Commits形式でコミットメッセージを記述する
4. **プッシュする**（必要に応じて）
   - リモートリポジトリに変更を反映する

**コミットメッセージの例:**

```
feat: ユーザー認証機能を実装

- JWT認証を実装
- ログイン/ログアウトエンドポイントを追加
- 認証ミドルウェアを実装
```

### 8. 次のタスクへの移行

現在のタスクが完了したら、次のタスクに進む。
- タスク計画書に従い、依存関係を考慮して次のタスクを選択する

**移行の手順:**

1. **現在のタスクの完了確認**
   - すべてのコードが実装されている
   - すべてのテストが成功している
   - 品質チェックが成功している
   - ドキュメントが更新されている
   - Gitにコミットされている

2. **次のタスクの特定**
   - タスク計画書の依存関係図を確認する
   - 前提タスクがすべて完了しているタスクを選択する
   - 優先順位が高いタスクを選択する

3. **次のタスクの開始**
   - ステップ1（タスク計画書の確認）に戻り、次のタスクを実装する

**すべてのタスクが完了した場合:**

- 最終的な品質チェックを実施する
- 実装レポートを完成させる
- checking-contradictionsスキルで一貫性を検証する

### 9. 完了確認（すべてのタスク完了時）

実装が完了したことを確認する。
- すべての項目が完了し、次フェーズに進める状態であることを確認する

**確認する項目:**

- [ ] タスク計画書のすべてのタスクが完了している
- [ ] すべてのコンポーネントが実装されている
- [ ] すべてのテストが成功している
- [ ] 品質チェックがすべて成功している
- [ ] ドキュメントが更新されている
- [ ] 実装レポートが作成されている
- [ ] Git運用が適切に行われている

**次のステップ:**

- **checking-contradictions**: プロジェクト全体の矛盾検出を実施する
- **コードレビュー**: チームメンバーによるレビューを実施する（チーム開発の場合）

## 出力

実装フェーズの成果物。以下の項目を含む：

1. **実装コード**: 詳細設計に基づくプロダクションコード
2. **テストコード**: ユニットテスト、統合テスト
3. **更新されたドキュメント**: README、API仕様、コメント等
4. **実装レポート**: 実装内容のサマリー、テスト結果、残課題、次のステップ

**重要:** 実装コードはcoding-conventionsに準拠し、テストがすべて成功していること。

## 注意事項

- **タスク計画の遵守**: タスク計画書の順序と依存関係に従って実装する
- **規約の遵守**: coding-conventions、branch-commit-conventions、document-conventionsを必ず参照する
- **段階的な進行**: 各タスクの完了後、次のタスクに進む前に完了確認を行う
- **品質優先**: テストが失敗している状態で次のタスクに進まない
- **ユーザーとの対話**: 要件が不明確な場合は、推測せずにユーザーに質問する
- **進捗の記録**: タスク完了時にタスク計画書を更新し、進捗を可視化する
- **EXAMPLE参照**: [EXAMPLE.md](EXAMPLE.md)

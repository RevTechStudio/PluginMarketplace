# Claude Code プラグイン作成ガイドライン

Claude Codeプラグイン開発時に従うべきルールと設計原則。

## 適用範囲

このガイドラインは、RevTechStudioマーケットプレイスで配布されるすべてのプラグインに適用される。

## スキル設計原則

### 関心の分離（Separation of Concerns）

スキルは**ドメインロジック**に集中し、**インフラ的な関心事**は外部に委譲する。

**ドメインロジック（スキルの責務）:**

- ビジネスルール
- ドメイン知識
- ワークフロー
- 生成するコンテンツの構造と内容

**インフラ的な関心事（外部の責務）:**

- ファイルパス
- ディレクトリ構造
- 環境依存の設定
- プロジェクト固有の構造

## ファイルパス管理ルール

### ドキュメント生成スキルの場合

**原則:**

- **コマンド側**: ファイルパスを定義・管理
- **スキル側**: ドキュメント内容の生成に集中

**理由:**

- 関心の分離を維持
- スキルの再利用性向上
- ファイルパス変更時の影響範囲を限定
- プロジェクト構造の変更に柔軟に対応
- 異なるプロジェクトで同じスキルを再利用可能

### 実装例

#### 良い例

**コマンド (.claude/commands/brainstorm.md):**

```markdown
brainstormスキルを使用してアイディアを深掘りしてください。

生成したドキュメントは以下のパスに保存：
- ./.spec/brainstorm_result.md
```

**スキル (skills/brainstorm/SKILL.md):**

```markdown
### ドキュメント化

ユーザーが承認した場合、以下の6項目を含むドキュメントを作成する。

**ドキュメント構成:**

1. プロジェクト概要
2. ターゲットユーザー
3. 解決する課題
...

**ドキュメント形式:**

- Markdown形式で生成
- 保存先はコマンドで指定されたパスを使用
```

#### 悪い例

**スキル (skills/brainstorm/SKILL.md):**

```markdown
### ドキュメント化

ドキュメントを ./.spec/brainstorm_result.md に保存する。
```

**問題点:**

- パス変更時にスキル自体を修正する必要がある
- プロジェクト構造に依存している
- 他のプロジェクトで再利用できない
- スキルとインフラの関心事が混在

## 例外

以下の場合はスキル内でパスを指定してもよい：

1. **一時ファイル生成**
   - 例: `/tmp/`, `./.cache/`
   - 理由: 一時的な作業領域は標準的

2. **標準的な場所**
   - 例: `./README.md`, `./package.json`
   - 理由: プロジェクト共通の標準ファイル

3. **パスが仕様の一部**
   - 例: `./.github/workflows/` (GitHub Actions)
   - 理由: 外部ツールがパスを要求

## ドキュメンテーション

### スキルドキュメント（SKILL.md）

スキルドキュメントには以下を記載：

- スキルの目的と概要
- 使用タイミング
- ワークフロー
- 入力/出力の形式
- 例（具体的な使用例）

**パスの記述方法:**

- ❌ 「`./output/result.md`に保存」
- ✅ 「指定されたパスに保存」
- ✅ 「コマンドで定義されたパスを使用」

### コマンドドキュメント

コマンド内でパスを明示的に指定：

```markdown
スキル名を使用して処理を実行してください。

生成したドキュメントは以下のパスに保存：
- ./path/to/output.md
```

## チェックリスト

スキル作成時に確認：

- [ ] ファイルパスはコマンド側で定義されているか
- [ ] スキルはドメインロジックに集中しているか
- [ ] スキルは他のプロジェクトでも再利用可能か
- [ ] プロジェクト固有の構造に依存していないか
- [ ] Documentation Standards（文書化標準）に準拠しているか

## 関連ドキュメント

- [Documentation Standards](../rev-tech-studio-foundations/skills/documentation-standards/SKILL.md) - ドキュメント作成の標準
- [Coding Standards](../rev-tech-studio-foundations/skills/coding-standards/SKILL.md) - コーディング標準
- [Branch and Commit Rules](../rev-tech-studio-foundations/skills/branch-commit-rules/SKILL.md) - ブランチとコミットのルール
